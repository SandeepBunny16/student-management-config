# =================================================================
# DEPARTMENT SERVICE - CENTRALIZED CONFIGURATION
# This file is stored in Config Server Git repository
# Loaded by Department Service on startup via Config Server
# =================================================================

# =================================================================
# APPLICATION IDENTITY
# =================================================================
# What: The name of this application for Config Server identification
# Why: Config Server uses this name to find department-service.properties file
spring.application.name=department-service

# =================================================================
# SERVER CONFIGURATION
# =================================================================
# What: Port for Department Service to run on
# Why: 8082 assigned to Department Service in architecture
# How: Tomcat embedded server listens on this port
server.port=8082

# What: Enable response compression for better performance
# Why: Reduces bandwidth usage for JSON responses
# How: Compresses responses larger than 1KB
server.compression.enabled=true
server.compression.min-response-size=1024
server.compression.mime-types=application/json,application/xml,text/html

# =================================================================
# DATABASE CONFIGURATION
# =================================================================
# What: PostgreSQL database connection details
# Why: Department Service uses department_db for data persistence
# How: JDBC URL format for PostgreSQL connection

# Database URL: jdbc:postgresql://host:port/database
spring.datasource.url=jdbc:postgresql://localhost:5432/departmentdb

# Database credentials
spring.datasource.username=postgres
spring.datasource.password=postgres

# JDBC driver class for PostgreSQL
spring.datasource.driver-class-name=org.postgresql.Driver

# =================================================================
# JPA/HIBERNATE CONFIGURATION
# =================================================================
# What: JPA DDL mode (none = don't auto-generate schema)
# Why: Flyway handles schema management, not Hibernate
# How: Prevents Hibernate from modifying database schema
spring.jpa.hibernate.ddl-auto=none

# What: Show SQL queries in console (false for production)
# Why: SQL logging can impact performance
# How: Set to true only for debugging in development
spring.jpa.show-sql=false

# What: PostgreSQL dialect for Hibernate
# Why: Tells Hibernate to use PostgreSQL-specific features
# How: Automatically detected, but explicit for clarity
spring.jpa.properties.hibernate.dialect=org.hibernate.dialect.PostgreSQLDialect

# What: Format SQL queries in console logs
# Why: Makes SQL logs more readable during debugging
# How: Adds line breaks and indentation to SQL
spring.jpa.properties.hibernate.format_sql=true

# What: Hibernate JDBC LOB handling for PostgreSQL
# Why: Fixes PostgreSQL LOB issues in certain scenarios
# How: Disables contextual LOB creation
spring.jpa.properties.hibernate.jdbc.lob.non_contextual_creation=true

# What: Disable JPA open-in-view pattern
# Why: REST APIs don't need view-layer lazy loading
# How: Closes database sessions after service layer execution
spring.jpa.open-in-view=false

# =================================================================
# FLYWAY CONFIGURATION
# =================================================================
# What: Enable Flyway database migrations
# Why: Manages database schema version control
# How: Executes SQL scripts from db/migration folder on startup
spring.flyway.enabled=true

# What: Location of Flyway migration scripts
# Why: Tells Flyway where to find SQL migration files
# How: Classpath location in src/main/resources
spring.flyway.locations=classpath:db/migration

# What: Create baseline for existing database
# Why: Allows Flyway to work with existing databases
# How: Creates flyway_schema_history table with baseline
spring.flyway.baseline-on-migrate=true

# What: Validate migration scripts before execution
# Why: Ensures migration integrity and prevents corruption
# How: Checks checksums and versioning before applying
spring.flyway.validate-on-migrate=true

# =================================================================
# EUREKA CLIENT CONFIGURATION
# =================================================================
# What: Should this service register with Eureka?
# Why: Yes, for service discovery by other services
# How: Sends registration request to Eureka on startup
eureka.client.register-with-eureka=true

# What: Should this service fetch registry from Eureka?
# Why: Yes, to discover department Service dynamically
# How: Periodically fetches service registry information
eureka.client.fetch-registry=true

# What: Eureka Server URL for service registration
# Why: All services need to know Service Registry location
# How: HTTP Basic Auth credentials embedded in URL
eureka.client.service-url.defaultZone=http://eureka-admin:eureka123@localhost:8761/eureka/

# What: Unique instance identifier in Eureka
# Why: Distinguishes multiple instances of Department Service
# How: Format {service-name}:{port} for easy identification
eureka.instance.instance-id=${spring.application.name}:${server.port}

# What: Use IP address for service communication
# Why: More reliable than hostname in containers/cloud
# How: Registers actual IP address instead of hostname
eureka.instance.prefer-ip-address=true

# What: Heartbeat interval to Eureka (seconds)
# Why: Faster failure detection during development
# How: Sends heartbeat every 10 seconds instead of default 30
eureka.instance.lease-renewal-interval-in-seconds=10

# What: Expiration duration without heartbeat (seconds)
# Why: Faster instance cleanup during development
# How: Removes instance after 30 seconds without heartbeat
eureka.instance.lease-expiration-duration-in-seconds=30

# =================================================================
# FEIGN CLIENT CONFIGURATION
# =================================================================
# What: Connection timeout for Feign clients (milliseconds)
# Why: Prevents infinite waiting if department Service unavailable
# How: Fails after 5 seconds of connection attempts
feign.client.config.default.connect-timeout=5000

# What: Read timeout for Feign responses (milliseconds)
# Why: Prevents hanging if department Service slow/unresponsive
# How: Fails after 10 seconds waiting for response
feign.client.config.default.read-timeout=10000

# What: Feign client logging level
# Why: Helps debug department Service communication issues
# How: FULL logs complete request/response details
feign.client.config.default.logger-level=FULL

# =================================================================
# ACTUATOR ENDPOINTS CONFIGURATION
# =================================================================
# What: Which management endpoints to expose via HTTP
# Why: Essential endpoints for monitoring and health checks
# How: Actuator exposes these under /actuator base path
management.endpoints.web.exposure.include=health,info,metrics

# What: Health check detail level
# Why: Detailed information helps debugging and monitoring
# How: Includes database status, disk space, Eureka status
management.endpoint.health.show-details=always

# =================================================================
# LOGGING CONFIGURATION
# =================================================================
# What: Log level for Department Service application code
# Why: DEBUG level for detailed development logging
# How: Shows method execution, data flow, business logic
logging.level.com.sandeep.department_service=DEBUG

# What: Log level for Feign client operations
# Why: Shows HTTP requests/responses to department Service
# How: DEBUG level logs request URL, headers, response status
logging.level.feign=DEBUG

# What: Log level for Spring Web components
# Why: Shows HTTP request/response processing
# How: INFO level shows important web events without noise
logging.level.org.springframework.web=INFO

# What: Log level for Spring Data JPA operations
# Why: Shows repository method execution
# How: INFO level shows important data access events
logging.level.org.springframework.data=INFO

# What: Log level for Hibernate SQL queries
# Why: Shows executed SQL statements
# How: INFO level shows SQL without parameter values
logging.level.org.hibernate.SQL=INFO

# What: Log level for SQL parameter binding
# Why: Shows parameter values in SQL queries (if needed)
# How: INFO level shows basic binding information
logging.level.org.hibernate.type.descriptor.sql.BasicBinder=INFO

# What: Default log level for all other code
# Why: Manageable console output during development
# How: INFO level shows important events without excessive detail
logging.level.root=INFO

# What: Console log message format
# Why: Clean, readable format for development
# How: Includes timestamp, thread, level, logger, message
logging.pattern.console=%d{HH:mm:ss} [%thread] %-5level %logger{36} - %msg%n
